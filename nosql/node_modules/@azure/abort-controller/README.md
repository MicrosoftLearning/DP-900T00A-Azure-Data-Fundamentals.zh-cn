---
ms.openlocfilehash: fe1a29595719e88783616e54c070b9b946052910
ms.sourcegitcommit: e739004291428ce83f14b9d49f1e9dfaa3762dde
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 02/05/2022
ms.locfileid: "138050805"
---
# <a name="azure-abort-controller-library-for-javascript"></a>适用于 JavaScript 的 Azure 中止控制器库

`@azure/abort-controller` 包提供 `AbortController` 和 `AbortSignal` 类。 这些类与现代浏览器中内置的 [AbortController](https://developer.mozilla.org/docs/Web/API/AbortController) 以及[提取](https://developer.mozilla.org/docs/Web/API/Fetch_API)使用的 `AbortSignal` 兼容。
使用 `AbortController` 类创建一个 `AbortSignal` 类的实例，该实例可用于取消 Azure SDK 中接受类型为 `AbortSignalLike` 的参数的操作。

## <a name="getting-started"></a>入门

### <a name="installation"></a>安装

使用 npm 安装此库，如下所示

```
npm install @azure/abort-controller
```

## <a name="key-concepts"></a>关键概念

使用 `AbortController` 创建 `AbortSignal`，然后可以将其传递给 Azure SDK 操作以取消挂起的工作。 可以通过实例化的 `AbortController` 上的 `signal` 属性访问 `AbortSignal`。
也可以直接从静态方法返回 `AbortSignal`，例如 `AbortController.timeout(100)`。
100 毫秒后取消。

在实例化的 `AbortController` 上调用 `abort()` 将调用关联的 `AbortSignal` 上已注册的 `abort` 事件侦听器。
在同一控制器上对 `abort()` 的任何后续调用都将不起作用。

`AbortSignal.none` 静态属性返回一个无法中止的 `AbortSignal`。

可以链接 `AbortSignal` 的多个实例，以便在父信号上调用 `abort()` 时中止所有链接的信号。
此链接是单向的，这意味着父信号可能会影响链接的信号，但反过来则不行。
要将 `AbortSignals` 链接在一起，请将父信号传递给 `AbortController` 构造函数。

## <a name="examples"></a>示例

以下示例假设 `doAsyncWork` 是一个函数，它接受一系列属性，其中一个属性是中止信号。

### <a name="example-1---basic-usage"></a>示例 1 - 基本用法

```js
import { AbortController } from "@azure/abort-controller";

const controller = new AbortController();
doAsyncWork({ abortSignal: controller.signal });

// at some point later
controller.abort();
```

### <a name="example-2---aborting-with-timeout"></a>示例 2 - 超时中止

```js
import { AbortController } from "@azure/abort-controller";

const signal = AbortController.timeout(1000);
doAsyncWork({ abortSignal: signal });
```

### <a name="example-3---aborting-sub-tasks"></a>示例 3 - 中止子任务

```js
import { AbortController } from "@azure/abort-controller";

const allTasksController = new AbortController();

const subTask1 = new AbortController(allTasksController.signal);
const subtask2 = new AbortController(allTasksController.signal);

allTasksController.abort(); // aborts allTasksSignal, subTask1, subTask2
subTask1.abort(); // aborts only subTask1
```

### <a name="example-4---aborting-with-parent-signal-or-timeout"></a>示例 4 - 父信号或超时中止

```js
import { AbortController } from "@azure/abort-controller";

const allTasksController = new AbortController();

// create a subtask controller that can be aborted manually,
// or when either the parent task aborts or the timeout is reached.
const subTask = new AbortController(allTasksController.signal, AbortController.timeout(100));

allTasksController.abort(); // aborts allTasksSignal, subTask
subTask.abort(); // aborts only subTask
```

## <a name="contributing"></a>贡献

要为此库做出贡献，请阅读[贡献指南](https://github.com/Azure/azure-sdk-for-js/blob/master/CONTRIBUTING.md)，了解有关如何生成和测试代码的详细信息。

![曝光数](https://azure-sdk-impressions.azurewebsites.net/api/impressions/azure-sdk-for-js%2Fsdk%2Fcore%2Fabort-controller%2FREADME.png)
