---
ms.openlocfilehash: b39271c36702513d70dc9f28e4cedb95c04a6525
ms.sourcegitcommit: e739004291428ce83f14b9d49f1e9dfaa3762dde
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 02/05/2022
ms.locfileid: "138050801"
---
# <a name="azure-core-tracing-library-for-javascript"></a>适用于 JavaScript 的 Azure 核心跟踪库

这是核心跟踪库，它提供低级别接口和帮助程序方法，以便在浏览器和 Node.js 中运行的 Azure SDK JavaScript 库中进行跟踪。

## <a name="getting-started"></a>入门

### <a name="installation"></a>安装

使用 npm 安装此库，如下所示

```
npm install @azure/core-tracing
```

## <a name="key-concepts"></a>关键概念

`@azure/core-tracing` 包支持使用 [OpenTelemetry](https://opentelemetry.io/) `Tracer` 为 Azure SDK 包启用跟踪。

默认情况下，所有库都使用不执行任何操作的 `NoOpTracer` 进行记录。
若要更改此行为，必须使用 `setTracer` 设置新的默认 `Tracer`。

## <a name="examples"></a>示例

### <a name="example-1---setting-an-opentelemetry-tracer"></a>示例 1 - 设置 OpenTelemetry 跟踪器

```js
const opentelemetry = require("@opentelemetry/api");
const { BasicTracer, SimpleSpanProcessor } = require("@opentelemetry/tracing");
const { ZipkinExporter } = require("@opentelemetry/exporter-zipkin");
const { setTracer } = require("@azure/core-tracing");

const exporter = new ZipkinExporter({
  serviceName: "azure-tracing-sample"
});
const tracer = new BasicTracer();
tracer.addSpanProcessor(new SimpleSpanProcessor(exporter));

setTracer(tracer);

const rootSpan = tracer.startSpan("root");
const context = opentelemetry.setSpan(opentelemetry.context.active(), rootSpan);

// Call some client library methods and pass rootSpan via tracingOptions.

rootSpan.end();
exporter.shutdown();
```

### <a name="example-2---passing-current-context-to-library-operations"></a>示例 2 - 将当前上下文传递给库操作

```js
// Given a BlobClient from @azure/storage-blob
const result = await blobClient.download(undefined, undefined, {
  tracingOptions: {
    tracingContext: context
  }
});
```

## <a name="next-steps"></a>后续步骤

可以通过执行 `rushx test` 在本地生成和运行测试。 浏览 `test` 文件夹以查看公共类的高级用法和行为。

## <a name="troubleshooting"></a>疑难解答

如果在使用此库时遇到问题，请随时[提出问题](https://github.com/Azure/azure-sdk-for-js/issues/new)。

## <a name="contributing"></a>贡献

要为此库做出贡献，请阅读[贡献指南](https://github.com/Azure/azure-sdk-for-js/blob/main/CONTRIBUTING.md)，了解有关如何生成和测试代码的详细信息。

![曝光数](https://azure-sdk-impressions.azurewebsites.net/api/impressions/azure-sdk-for-js%2Fsdk%2Fcore%2Fcore-tracing%2FREADME.png)
