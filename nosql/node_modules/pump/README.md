---
ms.openlocfilehash: a99dd16ee6283131f11f543fc7caf0badb805d7a
ms.sourcegitcommit: e739004291428ce83f14b9d49f1e9dfaa3762dde
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 02/05/2022
ms.locfileid: "138050761"
---
# <a name="pump"></a>泵

泵是一种小型节点模块，可通过管道将所有流连接在一起并在其中一个流关闭时将其全部销毁。

```
npm install pump
```

[![生成状态](http://img.shields.io/travis/mafintosh/pump.svg?style=flat)](http://travis-ci.org/mafintosh/pump)

## <a name="what-problem-does-it-solve"></a>它可解决什么问题？

如果 dest 发出关闭或错误，则使用标准 `source.pipe(dest)` 源时不会被销毁。
你也无法提供回调来判断管道何时完成。

泵为你做这两件事情

## <a name="usage"></a>使用情况

只需将你想要通过管道连接在一起的流传递到泵中，并添加可选的回调

``` js
var pump = require('pump')
var fs = require('fs')

var source = fs.createReadStream('/dev/random')
var dest = fs.createWriteStream('/dev/null')

pump(source, dest, function(err) {
  console.log('pipe finished', err)
})

setTimeout(function() {
  dest.destroy() // when dest is closed pump will destroy source
}, 1000)
```

还可以使用泵将两个以上的流通过管道连接在一起

``` js
var transform = someTransformStream()

pump(source, transform, anotherTransform, dest, function(err) {
  console.log('pipe finished', err)
})
```

如果 `source`、`transform`、`anotherTransform` 或 `dest` 关闭，所有这些都将被销毁。

与 `stream.pipe()` 类似，`pump()` 返回传入的最后一个流，因此你可以执行以下操作：

```
return pump(s1, s2) // returns s2
```

如果要将组合 s1 和 s2 的流返回到单个流，请改用 [pumpify](https://github.com/mafintosh/pumpify)。

## <a name="license"></a>许可

MIT

## <a name="related"></a>相关内容

`pump` 是[密西西比流实用工具集合](https://github.com/maxogden/mississippi)的一部分，其中包含与此类似的更有用的流模块。
