---
ms.openlocfilehash: faba66fd211251cabf9efd984bb907f35d419ce4
ms.sourcegitcommit: e739004291428ce83f14b9d49f1e9dfaa3762dde
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 02/05/2022
ms.locfileid: "138050637"
---
# <a name="open"></a>开门

> 打开 URL、文件、可执行文件等内容。 跨平台。

这应该在命令行工具和脚本中使用，而不是在浏览器中使用。

如果需要将此用于 Electron，请改用 [`shell.openPath()`](https://www.electronjs.org/docs/api/shell#shellopenpathpath)。

注意：原来的 [`open` 包](https://github.com/pwnall/node-open)以前已弃用，取而代之的是此包，我们获得了该包的名称，此包现在名为 `open` 而不是 `opn`。 如果要从原来的 `open` 包（`open@0.0.5` 或更低版本）升级，请记住 API 是不同的。

#### <a name="why"></a>为什么？

- 积极维护。
- 支持应用参数。
- 更安全，因为它使用 `spawn` 而不是 `exec`。
- 修复了大多数未解决的原始 `node-open` 问题。
- 包括适用于 Linux 的最新 [`xdg-open` 脚本](https://cgit.freedesktop.org/xdg/xdg-utils/commit/?id=c55122295c2a480fa721a9614f0e2d42b2949c18)。
- 支持 Windows应用的 WSL 路径。

## <a name="install"></a>安装

```
$ npm install open
```

## <a name="usage"></a>使用情况

```js
const open = require('open');

(async () => {
    // Opens the image in the default image viewer and waits for the opened app to quit.
    await open('unicorn.png', {wait: true});
    console.log('The image viewer app quit');

    // Opens the URL in the default browser.
    await open('https://sindresorhus.com');

    // Opens the URL in a specified browser.
    await open('https://sindresorhus.com', {app: 'firefox'});

    // Specify app arguments.
    await open('https://sindresorhus.com', {app: ['google chrome', '--incognito']});
})();
```

## <a name="api"></a>API

它在 macOS 上使用 `open` 命令，在 Windows 上使用 `start` 命令，在其他平台上使用 `xdg-open` 命令。

### <a name="opentarget-options"></a>open(target, options?)

返回[衍生子进程](https://nodejs.org/api/child_process.html#child_process_class_childprocess)的承诺。 通常不需要将它用于任何内容，但如果要附加自定义事件侦听器或直接在衍生进程上执行其他操作，则它非常有用。

#### <a name="target"></a>目标

类型：`string`

你希望打开的内容。 可以是 URL、文件或可执行文件。

在文件类型的默认应用中打开。 例如，URL 将在默认浏览器中打开。

#### <a name="options"></a>选项

类型：`object`

##### <a name="wait"></a>wait

类型：`boolean`\
默认：`false`

等待打开的应用退出，然后再履行承诺。 如果为 `false`，则会在打开应用时立即履行。

请注意，它等待应用退出，而不仅仅是窗口关闭。

在 Windows 上，必须显式指定一个应用才能使其等待。

##### <a name="background-supmacos-onlysup"></a>后台<sup>（仅限 macOS）</sup>

类型：`boolean`\
默认：`false`

不要将应用带到前台。

##### <a name="app"></a>应用

类型：`string | string[]`

指定要打开 `target` 的应用或具有应用和应用参数的数组。

应用名称取决于平台。 不要在可重用模块中对其进行硬编码。 例如，Chrome 在 macOS 上为 `google chrome`，在 Linux 上为 `google-chrome`，在 Windows 上为 `chrome`。

还可以传入应用的完整路径。 例如，在 WSL 上，对于 Windows 安装的 Chrome，路径可以是 `/mnt/c/Program Files (x86)/Google/Chrome/Application/chrome.exe`。

##### <a name="url"></a>url

类型：`boolean`\
默认：`false`

在执行目标之前使用 `URL` 对其进行编码。<br>
建议不要在非 URL 的目标上使用它。

在处理 [Windows 上的双引号](#double-quotes-on-windows)警告时特别有用。

##### <a name="allownonzeroexitcode"></a>allowNonzeroExitCode

类型：`boolean`\
默认：`false`

允许打开的应用在 `wait` 选项为 `true` 时使用非零退出代码退出。

建议不要设置此选项。 成功的约定是退出代码为零。

## <a name="caveats"></a>注意事项

### <a name="double-quotes-on-windows"></a>Windows 上的双引号

TL;DR:所有双引号都将从 `target` 中去除，并且无法到达期望的目标（在 Windows 上！）。

由于 Window 的命令提示符 (`cmd.exe`) 关于 `&` 字符中断命令和 URL 的特定行为，双引号现在是一个特殊情况。

此问题和其他问题的解决方案 ([#146](https://github.com/sindresorhus/open/pull/146)) 是利用以下事实：`cmd.exe` 只需双引号参数即可将其解释为纯文本参数（像 Node.js 所做的那样）。 遗憾的是，`cmd.exe` 只能执行以下两项操作之一：全部处理或完全不处理 。 根据自己的文档：

>如果指定了 /C 或 /K，则开关后面的命令行其余内容将作为命令行处理，其中以下逻辑用于处理引号 (") 字符：
>
>    1.  如果满足以下所有条件，则保留命令行上的引号字符：
>        - 无 /S 开关
>        - 正好两个引号字符
>        - 两个引号字符之间没有以下特殊字符：&<>()@^|
>        - 两个引号字符之间有一个或多个空格字符
>        - 两个引号字符之间的字符串是可执行文件的名称。
>
>    2.  否则，旧行为是查看第一个字符是否为引号字符，如果是，则去除前导字符并删除命令行上的最后一个引号字符，保留最后一个引号字符后面的任何文本。

解决了所有问题的选项是第二个选项，为实现更多行为一致性，我们现在还正在使用 `/S` 开关，因此我们始终获得第二个选项。 请注意，这种内置的双引号处理方法最终是从命令行中去除所有这些双引号，到目前为止，我们还未找到一种有效的转义方法（如果你找到了，请随意投稿！）。

若要降低此警告的影响（至少对 URL 而言），请查看 [URL 选项](#url)。 当双引号与 URL 一起使用时，双引号将被“保留”。

## <a name="related"></a>相关内容

- [open-cli](https://github.com/sindresorhus/open-cli) - 此模块的 CLI
- [open-editor](https://github.com/sindresorhus/open-editor) - 在编辑器中的特定行和列打开文件

---

<div align="center">
    <b>
        <a href="https://tidelift.com/subscription/pkg/npm-opn?utm_source=npm-opn&utm_medium=referral&utm_campaign=readme">通过 Tidelift 订阅获取此包的专业支持</a>
    </b>
    <br>
    <sub>Tidelift 有助于使开源对维护者具有可持续性，同时为公司<br>提供有关其依赖项的安全性、维护和许可的保证。
    </sub>
</div>
